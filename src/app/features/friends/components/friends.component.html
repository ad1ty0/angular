<div class="friends-container">
  <!-- Navigation -->
  <app-navigation></app-navigation>
  
  <!-- Main Content -->
  <div class="friends-main-content">
    <div class="container-fluid">
      <div class="row">
        <!-- Left Sidebar -->
        <div class="col-md-3 col-12">
          <div class="friends-sidebar">
            <h4 class="friends-title">Friends</h4>
            
            <!-- Find new friends -->
            <div class="friends-nav-item" 
                 [class.active]="currentSection === 'find-friends'"
                 (click)="setSection('find-friends')">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="nav-icon">
                <path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
              <span>Find new friends</span>
            </div>
            
            <!-- Friend requests -->
            <div class="friends-nav-item" 
                 [class.active]="currentSection === 'friend-requests'"
                 (click)="setSection('friend-requests')">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="nav-icon">
                <path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6h2.5l-2.54-7.63A1.5 1.5 0 0 0 18.54 8H17c-.8 0-1.54.37-2.01 1l-2.99 4.5V22h2v-6h2v6h4zM12.5 11.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5S11 9.17 11 10s.67 1.5 1.5 1.5zm1.5 1h-4c-.83 0-1.5.67-1.5 1.5v6h2V20h3v-1.5c0-.83.67-1.5 1.5-1.5z"/>
              </svg>
              <span>Friend requests</span>
              <span class="badge" *ngIf="friendRequests.length > 0">{{ friendRequests.length }}</span>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="chevron">
                <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
              </svg>
            </div>
            
            <!-- All friends -->
            <div class="friends-nav-item" 
                 [class.active]="currentSection === 'all-friends'"
                 (click)="setSection('all-friends')">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="nav-icon">
                <path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6h2.5l-2.54-7.63A1.5 1.5 0 0 0 18.54 8H17c-.8 0-1.54.37-2.01 1l-2.99 4.5V22h2v-6h2v6h4zM12.5 11.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5S11 9.17 11 10s.67 1.5 1.5 1.5zm1.5 1h-4c-.83 0-1.5.67-1.5 1.5v6h2V20h3v-1.5c0-.83.67-1.5 1.5-1.5z"/>
              </svg>
              <span>All friends</span>
              <span class="friend-count" *ngIf="allFriends.length > 0">{{ allFriends.length }}</span>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="chevron">
                <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
              </svg>
            </div>
          </div>
        </div>
        
        <!-- Right Content Area -->
        <div class="col-md-9 col-12">
          <div class="friends-content">
            
            <!-- Find New Friends Section -->
            <div *ngIf="currentSection === 'find-friends'" class="section-content">
              <h3 class="section-title">Find new friends</h3>
              <div class="user-cards-grid">
                <div class="user-card" *ngFor="let user of suggestedFriends">
                  <div class="user-card-image">
                    <img [src]="user.profileImage" [alt]="user.name" class="profile-image">
                  </div>
                  <div class="user-card-content">
                    <h5 class="user-name">{{ user.name }}</h5>
                    <button 
                      class="btn user-action-btn"
                      [class.btn-add-friend]="!user.requestSent"
                      [class.btn-cancel-request]="user.requestSent"
                      (click)="toggleFriendRequest(user)"
                      [disabled]="user.isLoading"
                    >
                      <span *ngIf="user.isLoading" class="spinner-border spinner-border-sm me-1"></span>
                      {{ user.requestSent ? 'Cancel Request' : 'Add Friend' }}
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Friend Requests Section -->
            <div *ngIf="currentSection === 'friend-requests'" class="section-content">
              <h3 class="section-title">Friend request ({{ friendRequests.length }})</h3>
              <div class="user-cards-grid">
                <div class="user-card" *ngFor="let request of friendRequests">
                  <div class="user-card-image">
                    <img [src]="request.profileImage" [alt]="request.name" class="profile-image">
                  </div>
                  <div class="user-card-content">
                    <h5 class="user-name">{{ request.name }}</h5>
                    <div class="request-status" *ngIf="request.isConfirmed">
                      <span class="status-text">You are now friends</span>
                      <button 
                        class="btn btn-view-profile"
                        (click)="viewProfile(request)"
                      >
                        View profile
                      </button>
                    </div>
                    <div class="request-actions" *ngIf="!request.isConfirmed">
                      <button 
                        class="btn btn-confirm"
                        (click)="confirmRequest(request)"
                        [disabled]="request.isLoading"
                      >
                        <span *ngIf="request.isLoading" class="spinner-border spinner-border-sm me-1"></span>
                        Confirm
                      </button>
                      <button 
                        class="btn btn-delete"
                        (click)="deleteRequest(request)"
                        [disabled]="request.isLoading"
                      >
                        Delete
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- All Friends Section -->
            <div *ngIf="currentSection === 'all-friends'" class="section-content">
              <div class="all-friends-header">
                <h3 class="section-title">All friends</h3>
                <div class="search-container">
                  <input 
                    type="text" 
                    class="form-control search-input" 
                    placeholder="Search Friends"
                    [(ngModel)]="searchTerm"
                    (input)="filterFriends()"
                  >
                </div>
              </div>
              
              <div class="friends-count" *ngIf="filteredFriends.length > 0">
                {{ filteredFriends.length }} friend{{ filteredFriends.length !== 1 ? 's' : '' }}
              </div>
              
              <div class="friends-list">
                <div class="friend-item" *ngFor="let friend of filteredFriends">
                  <div class="friend-image">
                    <img [src]="friend.profileImage" [alt]="friend.name" class="profile-image">
                  </div>
                  <div class="friend-info">
                    <h5 class="friend-name">{{ friend.name }}</h5>
                  </div>
                  <div class="friend-actions">
                    <button 
                      class="btn btn-view-profile"
                      (click)="viewProfile(friend)"
                    >
                      View Profile
                    </button>
                    <button 
                      class="btn btn-unfriend"
                      (click)="unfriend(friend)"
                      [disabled]="friend.isLoading"
                    >
                      <span *ngIf="friend.isLoading" class="spinner-border spinner-border-sm me-1"></span>
                      Unfriend
                    </button>
                  </div>
                </div>
              </div>
              
              <div *ngIf="filteredFriends.length === 0 && allFriends.length === 0" class="no-friends">
                <p>You don't have any friends yet. Start by finding new friends!</p>
              </div>
              
              <div *ngIf="filteredFriends.length === 0 && allFriends.length > 0" class="no-search-results">
                <p>No friends found matching "{{ searchTerm }}"</p>
              </div>
            </div>
            
          </div>
        </div>
      </div>
    </div>
  </div>
</div>